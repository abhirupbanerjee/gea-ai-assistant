(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1057:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5155),l=r(2115),a=r(8240),o=r(9923),n=r(5405);let i=()=>{let[e,t]=(0,l.useState)([]),[r,i]=(0,l.useState)(""),[c,d]=(0,l.useState)(null),[m,h]=(0,l.useState)(!1),[x,f]=(0,l.useState)(!1),[u,g]=(0,l.useState)(!1),p=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("chatHistory"),r=localStorage.getItem("threadId");if(e)try{t(JSON.parse(e))}catch(e){console.error("Error parsing saved messages:",e)}r&&d(r)},[]),(0,l.useEffect)(()=>{var e;null==(e=p.current)||e.scrollTo({top:p.current.scrollHeight,behavior:"smooth"})},[e]),(0,l.useEffect)(()=>{localStorage.setItem("chatHistory",JSON.stringify(e)),c&&localStorage.setItem("threadId",c)},[e,c]);let y=async()=>{if(x||!r.trim())return;f(!0),h(!0);let e={role:"user",content:r,timestamp:new Date().toLocaleString()};t(t=>[...t,e]),i("");try{let e;g(!0);let s=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r,threadId:c})});if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let l=await s.text();try{e=JSON.parse(l)}catch(e){throw console.error("Failed to parse JSON response:",l),Error("Invalid JSON response from server")}if(e.error)throw Error(e.error);e.threadId&&e.threadId!==c&&d(e.threadId),t(t=>[...t,{role:"assistant",content:e.reply||"No response received",timestamp:new Date().toLocaleString()}])}catch(r){console.error("Error:",r);let e="Unable to reach assistant.";r.message&&(e=r.message),t(t=>[...t,{role:"assistant",content:"Error: ".concat(e),timestamp:new Date().toLocaleString()}])}finally{g(!1),h(!1),f(!1)}},b=async()=>{let t=e.map(e=>"".concat(e.timestamp," - ").concat("user"===e.role?"You":"Grenada AI Assistant",":\n").concat(e.content)).join("\n\n");try{await navigator.clipboard.writeText(t),alert("Chat copied to clipboard!")}catch(e){console.error("Failed to copy chat: ",e),alert("Failed to copy chat to clipboard.")}};return(0,s.jsxs)("div",{className:"h-screen w-full flex flex-col bg-white",children:[(0,s.jsxs)("header",{className:"flex items-center justify-center w-full p-4 bg-white shadow-md",children:[(0,s.jsx)("img",{src:"/icon.png",alt:"Icon",className:"h-12 w-12 sm:h-16 sm:w-16"}),(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold ml-2",children:"Grenada AI Assistant"})]}),(0,s.jsx)("div",{className:"flex-grow w-full max-w-4xl mx-auto flex flex-col p-4",children:(0,s.jsxs)("div",{ref:p,className:"flex-grow overflow-y-auto border p-3 space-y-4 bg-white shadow rounded-lg h-[65vh] sm:h-[70vh]",children:[e.map((e,t)=>(0,s.jsxs)(o.P.div,{children:[(0,s.jsxs)("p",{className:"font-bold mb-1",children:["user"===e.role?"You":"Grenada AI Assistant"," ",e.timestamp&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.timestamp,")"]})]}),(0,s.jsx)("div",{className:"p-3 rounded-md ".concat("user"===e.role?"bg-gray-200 text-black":"bg-white text-black border"),children:(0,s.jsx)(a.oz,{remarkPlugins:[n.A],components:{h1:e=>{let{...t}=e;return(0,s.jsx)("h1",{style:{fontFamily:"'Segoe UI', sans-serif",fontSize:"1.75rem",fontWeight:"bold",margin:"1rem 0"},...t})},h2:e=>{let{...t}=e;return(0,s.jsx)("h2",{style:{fontFamily:"'Segoe UI', sans-serif",fontSize:"1.5rem",fontWeight:"bold",margin:"1rem 0"},...t})},h3:e=>{let{...t}=e;return(0,s.jsx)("h3",{style:{fontFamily:"'Segoe UI', sans-serif",fontSize:"1.25rem",fontWeight:"bold",margin:"1rem 0"},...t})},code:e=>{let{...t}=e;return(0,s.jsx)("code",{style:{fontFamily:"'Segoe UI', sans-serif",background:"#f3f4f6",padding:"0.2rem 0.4rem",borderRadius:"4px"},...t})},p:e=>{let{node:t,...r}=e;return(0,s.jsx)("p",{style:{marginBottom:"0.75rem",lineHeight:"1.6",fontFamily:"'Segoe UI', sans-serif",fontSize:"16px"},...r})},ul:e=>{let{node:t,...r}=e;return(0,s.jsx)("ul",{style:{listStyleType:"disc",paddingLeft:"1.5rem",marginBottom:"1rem"},...r})},ol:e=>{let{node:t,...r}=e;return(0,s.jsx)("ol",{style:{listStyleType:"decimal",paddingLeft:"1.5rem",marginBottom:"1rem"},...r})},li:e=>{let{node:t,...r}=e;return(0,s.jsx)("li",{style:{marginBottom:"0.4rem"},...r})},table:e=>{let{node:t,...r}=e;return(0,s.jsx)("table",{style:{borderCollapse:"collapse",width:"100%",marginBottom:"1rem"},...r})},th:e=>{let{node:t,...r}=e;return(0,s.jsx)("th",{style:{border:"1px solid #ccc",background:"#f3f4f6",padding:"8px",textAlign:"left"},...r})},td:e=>{let{node:t,...r}=e;return(0,s.jsx)("td",{style:{border:"1px solid #ccc",padding:"8px",textAlign:"left"},...r})}},children:e.content})})]},t)),u&&(0,s.jsx)("div",{className:"text-gray-500 italic text-center p-2",children:"Assistant is typing..."})]})}),(0,s.jsxs)("div",{className:"w-full max-w-4xl mx-auto p-4 flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[(0,s.jsx)("input",{className:"border rounded p-3 w-full sm:w-4/5",value:r,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&y(),placeholder:"Type a message..."}),(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white p-3 rounded w-full sm:w-1/5",onClick:y,disabled:m,children:m?"...":"Send"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,s.jsx)("button",{className:"bg-yellow-500 hover:bg-yellow-600 text-white p-3 rounded w-full",onClick:b,children:"Copy Chat"}),(0,s.jsx)("button",{className:"bg-red-400 hover:bg-red-500 text-white p-3 rounded w-full",onClick:()=>{t([]),d(null),localStorage.removeItem("threadId"),localStorage.removeItem("chatHistory")},children:"Clear Chat"})]})]})]})}},8085:(e,t,r)=>{Promise.resolve().then(r.bind(r,1057))}},e=>{var t=t=>e(e.s=t);e.O(0,[977,441,684,358],()=>t(8085)),_N_E=e.O()}]);